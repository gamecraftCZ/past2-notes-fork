\chapter{Odhady}

\section{Odhady faktoriálu}

Faktoriál: $n \in \mathbb{N}: n!$. Poskládání $n$ prvků.

\begin{tvrz}
	$\forall n \in \mathbb{N}: n^{n/2} \leq n! \leq n^n$
\end{tvrz}

\begin{proof}
	Horní odhad se dá napsat jako: $n! = \prod_{i=1}^{n}i \leq \prod_{i=1}^{n} n = n^{n}$. Dolní odhad použijeme, že $i(n+1 - i) \geq n$ (to platí pro $i=1$ a $i=n$). Potom pro $2 \leq i \leq \lceil \frac{n}{2} \rceil$ máme $i(n+1-i) \geq 2 \frac{n}{2} = n$. Obdobný odhad je i pro $\lceil \frac{n}{2} \rceil \leq i \leq n$. Následně $(n!)^2 = n1 \cdot n2 \dots 2(n-1) \cdot 1n \geq n^{n}$. Potom platí, že $n! \geq n^{n/2}$.
\end{proof}

\begin{veta}
	$\forall n \in \mathbb{N}: e (\frac{n}{e})^n \leq n! \leq en(\frac{n}{e})^n$
\end{veta}

\begin{proof}
	Horní odhad: Pro $n = 1$ platí $(1 = 1! \leq e 1 \left( \frac{1}{e} \right)^{1} = 1)$. Nechť $n \geq 2$.
	
	$$
	n! = n (n-1)! \leq n e (n-1)\left( \frac{n-1}{e} \right)^{n-1} = e n \left( \frac{n}{e} \right)^{n}e \left( \frac{n-1}{n} \right)^{n} - \left( \frac{n-1}{n} \right)^{n} =
	$$
	
	$$
	= e \left( 1 - \frac{1}{n} \right)^{n} \leq e \left( e^{\frac{-1}{n}} \right)^{n} = 1
	$$
	
	Dolní odhad: Pro $n = 1$ platí $(1 = \left( \frac{1}{n} \right)^{1} \leq 1! = 1)$. Nechť $n \geq 2$.
	
	$$
	n! = n(n-1)! \geq n e \left( \frac{n-1}{e} \right)^{n-1} = e \left( \frac{n}{e} \right)^{n} e \left( \frac{n-1}{n} \right)^{n-1} - \left( \frac{n-1}{n} \right)^{n-1} \geq 1
	$$
	
	$$
	\Updownarrow
	$$
	
	$$
	\frac{1}{e} \left( \frac{n}{n-1} \right)^{n-1} \leq 1
	$$
	
	$$
	\frac{1}{e} \left( \frac{n}{n-1} \right)^{n-1} = \frac{1}{e} \left( 1 + \frac{1}{n-1} \right)^{n-1} \leq \frac{1}{e} \left( e^{\frac{1}{n-1}} \right)^{n-1}
	$$
\end{proof}

\begin{lemma}
	$1+x \leq e^x$
\end{lemma}

\begin{proof}
	$f(x) := e^x - (x+1)$ chceme ukázat, že $f(x) \geq 0$ pro $\forall x \in \mathbb{R}$. $f'(x) = e^x - 1 \Rightarrow (f'(x) = 0 \Leftrightarrow x = 0)$. $f''(x) = e^x$. $f''(x) = 1 > 0 \Rightarrow$ v bodě $x = 0$ je globální minimum pro $f \Rightarrow f(x) \geq 0$ pro $\forall x \in \mathbb{R}$.
\end{proof}

\begin{veta}[Stirlingův vzorec]
	$n! \approx n \sqrt{2\pi n} (\frac{n}{e})^n$ $\lim_{n \to \infty} \frac{n!}{\sqrt{2\pi n}(\frac{n}{e})^n} = 1$
\end{veta}

\section{Binomický koeficient}

Počet $k$-prvkových podmnožin $n$-prvkových množin: 

$$
n,k \in \mathbb{N}: \binom{n}{k}=\frac{n!}{k!(n-k)!}
$$

\begin{pozor}
	\begin{enumerate}
		\item $\forall n,k \in \mathbb{N}: (\frac{n}{k})^k \leq \binom{n}{k} \leq n^k$
		\item největší prvek $\binom{n}{\lceil \frac{n}{2} \rceil} = \binom{n}{\lfloor \frac{n}{k} \rfloor}$
	\end{enumerate}	
\end{pozor}

\begin{proof}
	Empty.
\end{proof}

\subsection{Binomická věta}

$$
\frac{2^{2m}}{2m+1} \leq \binom{2m}{m} \leq 2^{2m}
$$

\begin{veta}
	$\forall m \in \mathbb{N}: \frac{2^{2m}}{2\sqrt{m}} \leq \binom{2m}{m} \leq \frac{2^{2m}}{\sqrt{2m}}$
\end{veta}

Užití Stirlingového vzorce: $\binom{2m}{m} \approx \frac{2^{2m}}{\sqrt{\pi m}}$. $\forall k,n \in \mathbb{N}: n > k, \binom{n}{k} \leq (\frac{en}{k})^k$.

\begin{proof}
	Empty.
\end{proof}

\subsection{Aplikace (náhodné procházky)}

$n$ kroků a v každém bodě mám $50\%$ že půjdu doprava anebo doleva. Střední hodnota počtu návratů do $0$. $X$ - počet návratů do $0$. $A_{2n}=$ jev po $2n$ krocích se dostanu do $0$. $X = \sum_{n=1}^{\infty} I_{A_{2n}}$. $\Pr[A_{2n}]=\frac{\binom{2n}{n}}{2^2n}$.

$$
\mathbb{E}[X] = \mathbb{E}[\sum_{n=1}^{\infty}I_{A_{2n}}] = \sum_{n=1}^{\infty} \mathbb{E} [I_{A_{2n}}] = 
$$

$$
= \sum_{n=1}^{\infty} Pr [I_{A_{2n}}] = \sum_{n=1}^{\infty} \frac{\binom{2n}{n}}{2^2n} \geq \sum_{n=1}^{\infty} \frac{1}{2\sqrt{n}} = \infty
$$
